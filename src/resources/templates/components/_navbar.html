{% import 'components/_macros.html' as macros %}
{% import 'components/_nav_link.html' as nav_link with context %}

<nav x-data="{ collapsed: false, activeUrl: '{{ request.url }}', isLogout: 'False' }"
     class="relative z-50 font-sans">

    <div class="hidden md:flex flex-col h-screen bg-base-100 transition-all duration-300 ease-in-out"
         :class="collapsed ? 'w-20' : 'w-64'">

        <div class="flex items-center h-16 px-4"
             :class="collapsed ? 'justify-center' : 'justify-between'">

            <span class="font-bold text-lg text-base-content truncate transition-all duration-1000"
                  :class="collapsed ? 'hidden' : 'visible'">
                Todo App
            </span>

            <button @click="collapsed = !collapsed"
                    class="p-1 rounded hover:bg-base-200 focus:outline-none text-base-content/70 hover:text-base-content cursor-pointer">
                <span class="transition-all duration-200 group-hover:scale-110"
                      :class="!collapsed ? 'visible' : 'hidden'">
                    {{ macros.render_icon('collapse') }}
               </span>
                <span class="transition-all duration-200 group-hover:scale-110"
                      :class="collapsed ? 'visible' : 'hidden'">
                    {{ macros.render_icon('open') }}
               </span>
            </button>
        </div>

        <div class="flex-1 py-6 space-y-2 overflow-y-auto">
            {{ nav_link.sidebar('My Task', 'my_task', url_for('dashboard').include_query_params(**request.query_params).include_query_params(mode="OWN"), url_for('dashboard_todos').include_query_params(**request.query_params).include_query_params(mode="OWN")) }}
            {{ nav_link.sidebar('Shared Task', 'shared_task', url_for('dashboard').include_query_params(**request.query_params).include_query_params(mode="SHARED"), url_for('dashboard_todos').include_query_params(**request.query_params).include_query_params(mode="SHARED")) }}
            {{ nav_link.sidebar('All Task', 'all_task', url_for('dashboard').include_query_params(**request.query_params).include_query_params(mode="ALL"), url_for('dashboard_todos').include_query_params(**request.query_params).include_query_params(mode="ALL")) }}
            {{ nav_link.sidebar('Stats', 'stats', '/stats', '/stats') }}
            {{ nav_link.sidebar('Settings', 'settings', '/settings', '/settings') }}
        </div>

        <div class="py-4">
            {{ nav_link.sidebar('Logout', 'logout', '/logout', '/logout', is_logout=True) }}
        </div>
    </div>


    <div class="md:hidden fixed bottom-0 left-0 right-0 bg-base-100 flex justify-around items-center h-16 pb-safe z-50 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)]">
        {{ nav_link.mobile(url_for('dashboard').include_query_params(**request.query_params).include_query_params(mode="OWN"), url_for('dashboard_todos').include_query_params(**request.query_params).include_query_params(mode="OWN"), 'my_task') }}
        {{ nav_link.mobile(url_for('dashboard').include_query_params(**request.query_params).include_query_params(mode="SHARED"), url_for('dashboard_todos').include_query_params(**request.query_params).include_query_params(mode="SHARED"), 'shared_task') }}
        {{ nav_link.mobile(url_for('dashboard').include_query_params(**request.query_params).include_query_params(mode="ALL"), url_for('dashboard_todos').include_query_params(**request.query_params).include_query_params(mode="ALL"), 'all_task') }}
        {{ nav_link.mobile_add('/add', '/add') }}
        {{ nav_link.mobile('/stats', '/stats', 'stats') }}
        {{ nav_link.mobile('/settings', '/settings', 'settings') }}
        {{ nav_link.mobile('/logout', '/logout', 'logout', is_logout=True) }}
    </div>
</nav>